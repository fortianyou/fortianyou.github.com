<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SVMä¹‹SMOç®—æ³•ç¬”è®°ï¼ˆä¹‹äºŒï¼‰ | foreyou&#39;s notes</title>
  <meta name="author" content="foreyou">
  
  <meta name="description" content="ä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œï¼Œä¸ç§¯å°æµæ— ä»¥æˆæ±Ÿæµ·">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="SVMä¹‹SMOç®—æ³•ç¬”è®°ï¼ˆä¹‹äºŒï¼‰"/>
  <meta property="og:site_name" content="foreyou&#39;s notes"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="foreyou&#39;s notes" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">foreyou&#39;s notes</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">		
			<h1> SVMä¹‹SMOç®—æ³•ç¬”è®°ï¼ˆä¹‹äºŒï¼‰</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
	

			

	<!-- content -->
	<div class="mypage">		
	    <p>ä¸Šä¸€ç¯‡æ–‡ç« <a href="/2015/05/27/SVMä¹‹SMOç®—æ³•ç¬”è®°ï¼ˆä¹‹ä¸€ï¼‰">ã€ŠSVMä¹‹SMOç®—æ³•ç¬”è®°ï¼ˆä¹‹ä¸€ï¼‰ã€‹</a>ä»‹ç»äº†SMOç®—æ³•çš„åŸç†ï¼Œæœ¬ç¯‡æ–‡ç« å°†è¦ä»‹ç»ç®—æ³•çš„å…·ä½“æ­¥éª¤ã€‚</p>
<h2 id="smoç®—æ³•çš„æ­¥éª¤">SMOç®—æ³•çš„æ­¥éª¤</h2>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“SMOç®—æ³•åœ¨æ¯ä¸ªè¿­ä»£ä¸­éƒ½è¦é€‰æ‹©ä¸€å¯¹<span class="math inline">\(\alpha_1\)</span>å’Œ<span class="math inline">\(\alpha_2\)</span>è¿›è¡Œä¼˜åŒ–æ›´æ–°ï¼Œå¯ä»¥æè¿°ä¸ºå¦‚ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol style="list-style-type: decimal">
<li><p>é‡‡ç”¨å¯å‘å¼çš„æ–¹æ³•é€‰æ‹©ä¸€å¯¹<span class="math inline">\(\alpha_1\)</span>å’Œ<span class="math inline">\(\alpha_2\)</span>ï¼Œä½¿å¾—æœ¬æ¬¡ä¼˜åŒ–æœ€å¤§ç¨‹åº¦æ¥è¿‘å…¨å±€æœ€ä¼˜å€¼ã€‚</p>
<p>(1)å¯»æ‰¾ç¬¬ä¸€ä¸ªè¿åKKTæ¡ä»¶çš„<span class="math inline">\(\alpha_1\)</span>ã€‚</p>
<p>(2)åœ¨non-boundå­é›†ä¸­é€‰å–ä½¿å¾—<span class="math inline">\(|E_1-E_2|\)</span>æœ€å¤§çš„<span class="math inline">\(\alpha_2\)</span>ã€‚</p></li>
<li><p>å›ºå®šé™¤äº†<span class="math inline">\(\alpha_1\)</span>å’Œ<span class="math inline">\(\alpha_2\)</span>ä¹‹å¤–çš„å…¶ä»–å‚æ•°ï¼Œå¯¹ç›®æ ‡å‡½æ•°æœ€ä¼˜åŒ–æ±‚å‚æ•°ã€‚</p></li>
</ol>
<a id="more"></a>
<h3 id="first-choice">First Choice</h3>
<blockquote>
<p>The first choice heuristic concentrates the CPU time on the examples that are most likely to violate the KKT conditions: the non-bound subset. As the SMO algorithm progresses, Lagrange multipliers that are at the bounds are likely to stay at the bounds, while Lagrange multipliers that are not at the bounds will change as other examples are optimized.</p>
</blockquote>
<p>é‡‡ç”¨å¯å‘å¼çš„æ–¹æ³•ï¼Œå…ˆåœ¨æœ€å¯èƒ½å‡ºç°è¿åKKTæ¡ä»¶çš„non-boundå­é›†ä¸­å¯»æ‰¾ä¸€ä¸ªè¿èƒŒKKTæ¡ä»¶çš„<span class="math inline">\(\alpha\)</span>ã€‚</p>
<blockquote>
<p>The SMO algorithm will thus iterate over the non-bound subset until that subset is self-consistent, then SMO will scan the entire data set to search for any bound examples that have become KKT-violated due to optimizing the non-bound subset.</p>
</blockquote>
<p>SMOä¼šä¸€ç›´è¿­ä»£ï¼Œç›´åˆ°non-boundä¸­æ²¡æœ‰è¿èƒŒKKTæ¡ä»¶çš„<span class="math inline">\(\alpha\)</span>ä¹‹åï¼Œå†å»æ‰«æå…¨é›†å¯»æ‰¾è¿åKKTçš„<span class="math inline">\(\alpha\)</span>ã€‚</p>
<blockquote>
<p>SMO veries that the KKT conditions are fullled within <span class="math inline">\(\epsilon\)</span>. Typically,  can typically be set in the range <span class="math inline">\(10^{-2}\)</span> to <span class="math inline">\(10^{-3}\)</span>.</p>
</blockquote>
<h3 id="second-choice">Second Choice</h3>
<blockquote>
<p>Evaluating the kernel function k is time consuming, so SMO approximates the step size by the absolute value of the numerator in equation (12.6): <span class="math inline">\(|E_1 - E_2 |\)</span>. SMO keeps a cached error value E for every non-bound example in the training set and then chooses an error to approximately maximize the step size.</p>
</blockquote>
<p>åœ¨non-boundçš„å­é›†ä¸­é€‰å–ä¸€ä¸ªä½¿å¾—<span class="math inline">\(|E_1 - E_2|\)</span>è¾¾åˆ°æœ€å¤§çš„æ ·æœ¬ï¼Œå¯¹åº”çš„å‚æ•°è®°ä½œ<span class="math inline">\(\alpha_2\)</span></p>
<blockquote>
<p>Under unusual circumstances, SMO cannot make positive progress using the second choice heuristic described above. For example, positive progress cannot be made if the rst and second training examples share identical input vectors <span class="math inline">\(\overrightarrow{x}\)</span>, which causes the objective function to become at along the direction of optimization.</p>
</blockquote>
<h4 id="second-choice-hierarchy"><em>Second Choice Hierarchy</em></h4>
<blockquote>
<p>SMO uses a hierarchy of second choice heuristics until it nds a pair of Lagrange multipliers that can make positive progress.</p>
<ol style="list-style-type: upper-alpha">
<li>if the above heuristic does not make positive progress, then SMO starts iterating through the non-bound examples, searching for a second example that can make positive progress; ?</li>
<li>if none of the non-bound examples make positive progress, then SMO starts iterating through the entire training set until an example is found that makes positive progress.</li>
</ol>
<p>Both the iteration through the non-bound examples (A) and the iteration through the entire training set (B) are started at random locations in order not to bias SMO towards the examples at the beginning of the training set.</p>
</blockquote>
<p>ä¸ºäº†å¾—åˆ°<code>positive progress</code>ï¼Œé€‰æ‹©ç¬¬äºŒä¸ªLargrangeä¹˜å­çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol style="list-style-type: decimal">
<li><p>é‡‡ç”¨å¯å‘å¼çš„æ–¹æ³•é€‰æ‹©ä¸€å¯¹<span class="math inline">\(\alpha_1\)</span>å’Œ<span class="math inline">\(\alpha_2\)</span>ï¼Œä½¿å¾—æœ¬æ¬¡ä¼˜åŒ–æœ€å¤§ç¨‹åº¦æ¥è¿‘å…¨å±€æœ€ä¼˜å€¼ã€‚</p>
<ol style="list-style-type: decimal">
<li><p>å¯»æ‰¾ç¬¬ä¸€ä¸ªè¿åKKTæ¡ä»¶çš„<span class="math inline">\(\alpha_1\)</span>ã€‚</p></li>
<li><p>å¯»æ‰¾ç¬¬äºŒä¸ªLargrangeä¹˜å­ã€‚ (a). åœ¨non-boundå­é›†ä¸­é€‰å–ä½¿å¾—<span class="math inline">\(|E_1-E_2|\)</span>æœ€å¤§çš„<span class="math inline">\(\alpha_2\)</span>ã€‚ (b). å¦‚æœ(a)ä¸­æ²¡æœ‰è¾¾åˆ°<code>positive progress</code>ï¼ŒSMOæœå¯»æ‰€æœ‰çš„non-boundç›´åˆ°æœ‰<code>positive progress</code>ã€‚ (c). å¦‚æœ(b)ä¸­æ²¡æœ‰è¾¾åˆ°<code>positive progress</code>ï¼ŒSMOæœå¯»é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°<code>positive progress</code>ã€‚ (d). (b)å’Œ(c)çš„æœå¯»èµ·ç‚¹éƒ½æ˜¯éšæœºæŒ‘é€‰çš„ã€‚</p></li>
</ol></li>
</ol>
<h3 id="error-cache">Error Cache</h3>
<blockquote>
<p>Whenever a joint optimization occurs, the stored errors for all non-bound multipliers k that are not involved in the optimization are updated according to <span class="math display">\[E_k^{new} = E_k^{old} +  y_1(\alpha_1^{new} - \alpha_1^{old} )\kappa(x_1,x_k) +y_2(\alpha_2^{new,clipped} - \alpha_2^{old}  )\kappa(x_2,x_k) + b^{old} - b^{new}\]</span></p>
<p>When an error E is required by SMO, it will look up the error in the error cache if the corresponding Lagrange multiplier is not at bound. Otherwise, it will evaluate the current SVM decision function based on the current <span class="math inline">\(\alpha\)</span> vector.</p>
</blockquote>
<h4 id="java-å®ç°">Java å®ç°</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.ac.ict.textclass.classifier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.ac.ict.textclass.kernel.Kernel;</span><br><span class="line"><span class="keyword">import</span> cn.ac.ict.textclass.kernel.LinearKernel;</span><br><span class="line"><span class="keyword">import</span> cn.ac.ict.textclass.kernel.RBFKernel;</span><br><span class="line"><span class="keyword">import</span> cn.ac.ict.textclass.kernel.TanhKernel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SVM</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Logger logger = Logger.getLogger(SVM.class);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> alpha[];</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> C;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> tol;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> x[][];</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> kappa[][];</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> y[];</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> E[];</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> b;<span class="comment">//the threshold</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> bound[];</span><br><span class="line">	<span class="keyword">private</span> Kernel kernel;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> ITER = <span class="number">1000</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">double</span> min_value = <span class="number">0.00000000001</span>; </span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SVM</span><span class="params">(Kernel kernel)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.kernel = kernel;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">config</span><span class="params">(<span class="keyword">double</span> C,<span class="keyword">double</span> tol,<span class="keyword">int</span> iter)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.C = C;</span><br><span class="line">		<span class="keyword">this</span>.tol = tol;</span><br><span class="line">		<span class="keyword">this</span>.ITER = iter;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">function</span><span class="params">(<span class="keyword">int</span> I)</span></span>&#123;</span><br><span class="line">		<span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; alpha.length; ++ i )&#123;</span><br><span class="line">			res += alpha[i]*y[i]*kappa[i][I];</span><br><span class="line">		&#125;</span><br><span class="line">		res -= b;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">getE</span><span class="params">(<span class="keyword">int</span> I)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( bound[I] )&#123;<span class="comment">//cached non-bound error</span></span><br><span class="line">			E[I] = function(I) - y[I];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> E[I]; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">double</span> [][]x ,<span class="keyword">int</span> []y)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.x = x;</span><br><span class="line">		<span class="keyword">this</span>.y = y;</span><br><span class="line">		<span class="keyword">int</span> len = y.length;</span><br><span class="line">		alpha = <span class="keyword">new</span> <span class="keyword">double</span>[len];</span><br><span class="line">		E = <span class="keyword">new</span> <span class="keyword">double</span>[len];</span><br><span class="line">		bound = <span class="keyword">new</span> <span class="keyword">boolean</span>[len];</span><br><span class="line">		kappa = <span class="keyword">new</span> <span class="keyword">double</span>[len][len];</span><br><span class="line">		b = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++ i )&#123;</span><br><span class="line">			alpha[i] = <span class="number">0</span>;</span><br><span class="line">			bound[i] = <span class="keyword">true</span>;</span><br><span class="line">			E[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++ i )&#123;</span><br><span class="line">			<span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++ j)&#123;</span><br><span class="line">				kappa[i][j] = kernel.getKappa(x[i], x[j]);</span><br><span class="line">				kappa[j][i] = kappa[i][j];</span><br><span class="line">				System.out.print(kappa[i][j] + <span class="string">" "</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="javadoc">/**</span><br><span class="line">	 * </span><br><span class="line">	 *<span class="javadoctag"> @param</span> i1</span><br><span class="line">	 *<span class="javadoctag"> @param</span> i2</span><br><span class="line">	 *<span class="javadoctag"> @return</span></span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">takeStep</span><span class="params">(<span class="keyword">int</span> i1,<span class="keyword">int</span> i2)</span></span>&#123;	</span><br><span class="line">		<span class="keyword">if</span>( i1 == i2 )&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> s = y[i1]*y[i2];</span><br><span class="line">		<span class="keyword">double</span> E1 = getE(i1);</span><br><span class="line">		<span class="keyword">double</span> E2 = getE(i2);</span><br><span class="line">		<span class="keyword">double</span> L,H;<span class="comment">//for alpha[i2]</span></span><br><span class="line">		<span class="keyword">if</span>( s != <span class="number">1</span> )&#123;</span><br><span class="line">			L = Math.max(<span class="number">0</span>, alpha[i2] - alpha[i1] );</span><br><span class="line">			H = Math.min(C, C + alpha[i2] - alpha[i1]);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			L = Math.max(<span class="number">0</span>, alpha[i2] + alpha[i1] - C );</span><br><span class="line">			H = Math.min(C, alpha[i2] + alpha[i1]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>( Math.abs(L -H) &lt; min_value )&#123;</span><br><span class="line">			logger.info( <span class="string">" L == H , return false"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">double</span> k12 = kappa[i1][i2];</span><br><span class="line">		<span class="keyword">double</span> k11 = kappa[i1][i1];</span><br><span class="line">		<span class="keyword">double</span> k22 = kappa[i2][i2];</span><br><span class="line">		<span class="keyword">double</span> eta = <span class="number">2</span>*k12 - k11 - k22;</span><br><span class="line">		<span class="keyword">double</span> new_alpha_2 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>( eta &lt; <span class="number">0</span> )&#123;<span class="comment">//assert eta &lt;= 0</span></span><br><span class="line">			new_alpha_2 = alpha[i2] - y[i2]*(E1-E2)/eta;</span><br><span class="line"><span class="comment">//			logger.info("new_alpha_2 = " + new_alpha_2 +", E1 = " +E1+", E2 = "+E2 +", L = " + L +", H = "+H);</span></span><br><span class="line">			<span class="keyword">if</span>( new_alpha_2 &lt; L ) new_alpha_2 = L;</span><br><span class="line">			<span class="function"><span class="keyword">else</span> <span class="title">if</span><span class="params">( new_alpha_2 &gt; H )</span> new_alpha_2 </span>= H;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;<span class="comment">// eta == 0 in this case, which doesn't make positive progress.</span></span><br><span class="line">			<span class="comment">/*</span><br><span class="line">			Under unusual circumstances, eta will not be negative. A zero eta can occur if more than one training</span><br><span class="line">			example has the same input vector X. If eta==0, we need to evaluate the objective function at the two </span><br><span class="line">			endpoints, i.e. at L and H, and set a2(ç¬¬äºŒä¸ªä¹˜å­çš„æ–°å€¼) to be the one with larger objective function </span><br><span class="line">			value. The objective function is: obj=eta*a2^2/2 + (y2*(E1-E2)-eta*alph2)*a2+const</span><br><span class="line">			*/</span></span><br><span class="line">			<span class="keyword">double</span> c1 = eta/<span class="number">2</span>;</span><br><span class="line">			<span class="keyword">double</span> c2 = y[i2]*(E1-E2) - eta*alpha[i2];</span><br><span class="line">			<span class="keyword">double</span> Lobj = c1 *L*L + c2*L;<span class="comment">// objective function at alpha_j = L</span></span><br><span class="line">			<span class="keyword">double</span> Hobj = c1 *H*H + c2*H;<span class="comment">// objective function at alpha_j = H</span></span><br><span class="line">			<span class="keyword">if</span>( Lobj &gt; Hobj + min_value )&#123;</span><br><span class="line">				new_alpha_2 = L;</span><br><span class="line">			&#125;<span class="function"><span class="keyword">else</span> <span class="title">if</span><span class="params">( Lobj &lt; Hobj - min_value )</span></span>&#123;</span><br><span class="line">				new_alpha_2 = H;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				new_alpha_2 = alpha[i2];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//return false;</span></span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		logger.info("na2 = " + new_alpha_2 );</span></span><br><span class="line">		<span class="keyword">if</span>( new_alpha_2 &lt; min_value )&#123;</span><br><span class="line">			new_alpha_2 = <span class="number">0</span>;</span><br><span class="line">		&#125;<span class="function"><span class="keyword">else</span> <span class="title">if</span><span class="params">( new_alpha_2 &gt; C - min_value )</span></span>&#123;</span><br><span class="line">			new_alpha_2 = C;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//doesn't make positive progress</span></span><br><span class="line">		<span class="keyword">if</span>( Math.abs(new_alpha_2 - alpha[i2] ) &lt; min_value )&#123;</span><br><span class="line">			logger.info(<span class="string">"doesn't make positive progress, return false"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">double</span> new_alpha_1 = alpha[i1] + s*(alpha[i2] - new_alpha_2);</span><br><span class="line">		<span class="keyword">if</span>( <span class="number">0</span> &lt; new_alpha_1 &amp;&amp; new_alpha_1&lt;  C  )&#123;</span><br><span class="line">			bound[i1] = <span class="keyword">false</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			bound[i1] = <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>( <span class="number">0</span> &lt; new_alpha_2 &amp;&amp; new_alpha_2&lt;  C  )&#123;</span><br><span class="line">			bound[i2] = <span class="keyword">false</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			bound[i2] = <span class="keyword">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/*update parameters*/</span> </span><br><span class="line">		<span class="keyword">double</span> b1 = b + E1 + y[i1]*( new_alpha_1 - alpha[i1])*k11 + y[i2]*(new_alpha_2 - alpha[i2])*k12;</span><br><span class="line">		<span class="keyword">double</span> b2 = b + E2 + y[i1]*( new_alpha_1 - alpha[i1])*k12 + y[i2]*(new_alpha_2 - alpha[i2])*k22;</span><br><span class="line">		<span class="keyword">double</span> nb;</span><br><span class="line">		<span class="keyword">if</span>( !bound[i1] )&#123;</span><br><span class="line">			nb = b1;</span><br><span class="line">		&#125;<span class="function"><span class="keyword">else</span> <span class="title">if</span><span class="params">( !bound[i2] )</span></span>&#123;</span><br><span class="line">			nb = b2;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			nb = (b1+b2)/<span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/*update all cache error for non-bound examples*/</span></span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> k = <span class="number">0</span>; k &lt; E.length; ++ k )&#123;</span><br><span class="line">			<span class="keyword">if</span>( !bound[k])&#123;</span><br><span class="line">				E[k] = E[k] + y[i1]*(new_alpha_1 - alpha[i1])*kappa[k][i1] + y[i2]*(new_alpha_2 - alpha[i2])*kappa[k][i2] + b - nb;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		b = nb;</span><br><span class="line">		alpha[i1] = new_alpha_1;</span><br><span class="line">		alpha[i2] = new_alpha_2;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="javadoc">/**</span><br><span class="line">	 * Examine whether example I violate KKT condition. If yes, update it. </span><br><span class="line">	 *<span class="javadoctag"> @param</span> I example I</span><br><span class="line">	 *<span class="javadoctag"> @return</span> if update success return true, else false.</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">examine</span><span class="params">(<span class="keyword">int</span> I)</span></span>&#123;</span><br><span class="line">		<span class="keyword">double</span> EI = getE(I);</span><br><span class="line">		<span class="keyword">double</span> r = EI*y[I];</span><br><span class="line">		logger.info(<span class="string">" EI = "</span>+EI+<span class="string">", r = "</span>+r);</span><br><span class="line">		<span class="comment">/*</span><br><span class="line">		 * KKT condition</span><br><span class="line">		 * alpha == 0  &lt;==&gt; yi*f(xi) &gt;= 1 &lt;==&gt; yi*Ei &gt;= 0 </span><br><span class="line">		 * 0&lt; alpha &lt;C &lt;==&gt; yi*f(xi) == 1 &lt;==&gt; yi*Ei == 0 ( support vector )</span><br><span class="line">		 * alpha == C  &lt;==&gt; yi*f(xi) &lt;= 1 &lt;==&gt; yi*Ei &lt;= 0 </span><br><span class="line">		 * </span><br><span class="line">		 * It obeys KKT, if r &lt; 0 and alpha &lt; C;</span><br><span class="line">		 * Because alpha == C when r &lt; 0 under KKT condition.</span><br><span class="line">		 * Also it obeys KKT, if r &gt; 0 and alpha &gt; 0;</span><br><span class="line">		 * Because alpha == 0 when r &gt; 0 under KKT condition. </span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">if</span>( ( r &lt; -tol &amp;&amp; alpha[I] &lt; C ) || ( r &gt; tol &amp;&amp; alpha[I] &gt; <span class="number">0</span> ) )<span class="comment">//obey KKT condition</span></span><br><span class="line">		&#123;</span><br><span class="line">			logger.info(<span class="string">"sample "</span> + I +<span class="string">" violates KKT."</span>);</span><br><span class="line">			<span class="keyword">double</span> max = -<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">int</span> J = -<span class="number">1</span>;</span><br><span class="line">			<span class="comment">/*Hierarchy 1: select alpha which maximizes |E1-E2| from non-bound alphas*/</span></span><br><span class="line">			<span class="keyword">for</span>( <span class="keyword">int</span> j = <span class="number">0</span>; j &lt; bound.length; ++ j )&#123;<span class="comment">//select </span></span><br><span class="line">				<span class="keyword">if</span>( I == j || bound[j]) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">double</span> Ej = getE(j);</span><br><span class="line">				<span class="keyword">if</span>( Math.abs( EI - Ej ) &gt; max )&#123;</span><br><span class="line">					max = Math.abs(EI - Ej);</span><br><span class="line">					J = j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>( J &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">				logger.info(<span class="string">"Hierarchy 1: J = "</span> + J );</span><br><span class="line">				<span class="keyword">if</span>(takeStep(J,I))<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">/*Hirearchy 2: scan non-bound subset started at random location until it makes positive progress*/</span></span><br><span class="line">			<span class="keyword">int</span> rand = (<span class="keyword">int</span>)Math.random()*bound.length;</span><br><span class="line">			<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; bound.length; ++ i)&#123;</span><br><span class="line">				<span class="keyword">int</span> j = (rand+i)%bound.length;</span><br><span class="line">				<span class="keyword">if</span>( I == j || bound[j] || j == J) <span class="keyword">continue</span>;</span><br><span class="line">				logger.info(<span class="string">"Hierarchy 2: J = "</span> + j );</span><br><span class="line">				<span class="keyword">if</span>( takeStep(j,I) ) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">/*Hierarchy 3: scan the entire train set( exclusive non-bound ) started at random location until it makes positive progress*/</span></span><br><span class="line">			rand = (<span class="keyword">int</span>)Math.random()*bound.length;</span><br><span class="line">			<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; y.length; ++ i )&#123;</span><br><span class="line">				<span class="keyword">int</span> j = (rand+i)%bound.length;</span><br><span class="line">				<span class="keyword">if</span>( I == j || !bound[j]) <span class="keyword">continue</span>;</span><br><span class="line">				logger.info(<span class="string">"Hierarchy 3: J = "</span> + j );</span><br><span class="line">				<span class="keyword">if</span>( takeStep(j,I)) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">train</span><span class="params">(<span class="keyword">double</span> x[][],<span class="keyword">int</span> y[])</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>( x.length != y.length )&#123;</span><br><span class="line">			System.out.println( <span class="string">"The input vectors' length are not the same."</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		init(x,y);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> numChanged = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">boolean</span> examineAll = <span class="keyword">true</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> iter = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">/*</span><br><span class="line">		while( iter ++ &lt; ITER )&#123;</span><br><span class="line">			for( int i = 0; i &lt; alpha.length; ++ i )&#123;</span><br><span class="line">				examine( i );</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;*/</span></span><br><span class="line">		<span class="keyword">while</span>( iter++ &lt; ITER &amp;&amp; (numChanged&gt;<span class="number">0</span> || examineAll ))&#123;</span><br><span class="line">			numChanged = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>( examineAll )&#123;</span><br><span class="line">				<span class="comment">//loop I over all training examples</span></span><br><span class="line">				<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; alpha.length; ++ i )&#123;</span><br><span class="line">					</span><br><span class="line">					<span class="keyword">if</span>( examine(i) )</span><br><span class="line">						numChanged += <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="comment">//loop I over examples where alpha is not 0 &amp; not C, non-bound subset</span></span><br><span class="line">				<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; alpha.length; ++ i )&#123;</span><br><span class="line">					<span class="keyword">if</span>( !bound[i] )&#123;</span><br><span class="line">						<span class="keyword">if</span>( examine(i) )</span><br><span class="line">							numChanged += <span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			</span><br><span class="line">			&#125;</span><br><span class="line"><span class="comment">//			logger.info("numChanged = " + numChanged);</span></span><br><span class="line">			<span class="keyword">if</span>( examineAll ) examineAll = <span class="keyword">false</span>;</span><br><span class="line">			<span class="function"><span class="keyword">else</span> <span class="title">if</span><span class="params">( numChanged == <span class="number">0</span> )</span></span>&#123;</span><br><span class="line">				examineAll = <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		System.out.println( <span class="string">"iter "</span> + iter );</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">predict</span><span class="params">(<span class="keyword">double</span> x[])</span></span>&#123;</span><br><span class="line">		<span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x.length; ++ i )&#123;</span><br><span class="line">			<span class="keyword">if</span>( alpha[i] &lt; min_value )<span class="keyword">continue</span>;</span><br><span class="line">			res += y[i] * alpha[i]* kernel.getKappa(x, <span class="keyword">this</span>.x[i]);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		System.out.println(b);</span></span><br><span class="line">		res -= b;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printParameters</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> y[] = &#123;-<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,-<span class="number">1</span>,<span class="number">1</span>,-<span class="number">1</span>&#125;;</span><br><span class="line">		<span class="keyword">double</span> x[][] = &#123;</span><br><span class="line">				&#123;<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>&#125;,</span><br><span class="line">				&#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>&#125;,</span><br><span class="line">				&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>&#125;,</span><br><span class="line">				&#123;<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>&#125;,</span><br><span class="line">				&#123;<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>&#125;,</span><br><span class="line">				&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">				&#123;<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">double</span> xt [][] =&#123;</span><br><span class="line">				&#123;<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>&#125;,</span><br><span class="line">				&#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>&#125;,</span><br><span class="line">				&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>&#125;,</span><br><span class="line">				&#123;<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>&#125;,</span><br><span class="line">				&#123;<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>&#125;,</span><br><span class="line">				&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">				&#123;<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>&#125;</span><br><span class="line">		&#125;;</span><br><span class="line"><span class="comment">//		Kernel kernel = new LinearKernel();</span></span><br><span class="line"><span class="comment">//		Kernel kernel = new RBFKernel();</span></span><br><span class="line">		TanhKernel kernel = <span class="keyword">new</span> TanhKernel();</span><br><span class="line">		kernel.config(<span class="number">0.01</span>, <span class="number">1</span>);</span><br><span class="line">		SVM svm = <span class="keyword">new</span> SVM(kernel);</span><br><span class="line">		svm.config(<span class="number">10</span>, <span class="number">0.001</span>,<span class="number">100</span>);</span><br><span class="line">		svm.train(x, y);</span><br><span class="line">		<span class="keyword">for</span>( <span class="keyword">double</span> t [] : xt )&#123;</span><br><span class="line">			System.out.println(<span class="string">""</span>+ svm.predict(t) + <span class="string">" "</span> + (svm.predict(t) &gt; <span class="number">0</span> ? <span class="number">1</span> : - <span class="number">1</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/2015/06/07/how-to-do-gibbs-sampling/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>ä¸Šä¸€é¡µ</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2015/05/27/SVMä¹‹SMOç®—æ³•ç¬”è®°ï¼ˆä¹‹ä¸€ï¼‰/" class="alignright next">ä¸‹ä¸€é¡µ<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">ç•™è¨€</h2>

  
  	 <div id="disqus_thread">
     <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  	 </div>
  
</section>

	
	</div> <!-- col-md-9/col-md-12 -->
	
	
		<div class="col-md-3"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2015-05-27 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/æœºå™¨å­¦ä¹ /">æœºå™¨å­¦ä¹ <span>2</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/SVM/">SVM<span>2</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
			<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#smoç®—æ³•çš„æ­¥éª¤"><span class="toc-article-text">SMOç®—æ³•çš„æ­¥éª¤</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#first-choice"><span class="toc-article-text">First Choice</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#second-choice"><span class="toc-article-text">Second Choice</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#second-choice-hierarchy"><span class="toc-article-text">Second Choice Hierarchy</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#error-cache"><span class="toc-article-text">Error Cache</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#java-å®ç°"><span class="toc-article-text">Java å®ç°</span></a></li></ol></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	

</div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2015 foreyou
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>â–²</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<script type="text/javascript">
var disqus_shortname = 'fortianyou';
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<!--or page.mathjax-->
<!-- add by roger at 2015/06/27 to support mathjax -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    }); 
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</body>
   </html>
